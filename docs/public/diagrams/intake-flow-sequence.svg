<svg xmlns="http://www.w3.org/2000/svg" width="1500" height="1200" viewBox="0 0 1500 1200" role="img" aria-labelledby="title desc">
  <title id="title">End-to-End Intake Flow</title>
  <desc id="desc">Pictorial sequence from upload to final result with repair, correction, and human review decisions.</desc>

  <defs>
    <linearGradient id="bg" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#f6f9ff"/>
      <stop offset="100%" stop-color="#eef7f1"/>
    </linearGradient>
    <linearGradient id="card" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#ffffff"/>
      <stop offset="100%" stop-color="#f8fbff"/>
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="160%">
      <feDropShadow dx="0" dy="5" stdDeviation="8" flood-color="#0f172a" flood-opacity="0.16"/>
    </filter>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto">
      <path d="M0,0 L10,5 L0,10 z" fill="#334155"/>
    </marker>
    <marker id="arrowBlue" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto">
      <path d="M0,0 L10,5 L0,10 z" fill="#0f5cad"/>
    </marker>
  </defs>

  <rect x="0" y="0" width="1500" height="1200" fill="url(#bg)"/>

  <text x="48" y="56" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="36" font-weight="700" fill="#0f172a">End-to-End Flow (Pictorial)</text>
  <text x="48" y="86" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="17" fill="#334155">Upload to workflow completion, including repair/correction branches and human review loop.</text>

  <g filter="url(#shadow)">
    <rect x="120" y="130" width="420" height="74" rx="16" fill="url(#card)" stroke="#60a5fa" stroke-width="2"/>
    <text x="146" y="175" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="20" font-weight="700" fill="#0f172a">1. Upload document via API</text>

    <rect x="120" y="248" width="420" height="74" rx="16" fill="url(#card)" stroke="#60a5fa" stroke-width="2"/>
    <text x="146" y="293" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="20" font-weight="700" fill="#0f172a">2. API writes object to MinIO</text>

    <rect x="120" y="366" width="420" height="74" rx="16" fill="url(#card)" stroke="#34d399" stroke-width="2"/>
    <text x="146" y="411" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="20" font-weight="700" fill="#0f172a">3. MinIO emits ObjectCreated event</text>

    <rect x="120" y="484" width="420" height="74" rx="16" fill="url(#card)" stroke="#818cf8" stroke-width="2"/>
    <text x="146" y="529" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="20" font-weight="700" fill="#0f172a">4. event-handler starts workflow</text>

    <rect x="120" y="602" width="420" height="74" rx="16" fill="url(#card)" stroke="#6366f1" stroke-width="2"/>
    <text x="146" y="647" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="20" font-weight="700" fill="#0f172a">5. Workflow runs in worker</text>

    <rect x="120" y="720" width="420" height="74" rx="16" fill="url(#card)" stroke="#3b82f6" stroke-width="2"/>
    <text x="146" y="765" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="20" font-weight="700" fill="#0f172a">6. Store + classify</text>

    <rect x="120" y="838" width="420" height="74" rx="16" fill="url(#card)" stroke="#8b5cf6" stroke-width="2"/>
    <text x="146" y="883" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="20" font-weight="700" fill="#0f172a">7. Phase A: extract</text>

    <rect x="120" y="956" width="420" height="74" rx="16" fill="url(#card)" stroke="#0ea5e9" stroke-width="2"/>
    <text x="146" y="1001" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="20" font-weight="700" fill="#0f172a">8. Validate rules + confidence</text>

    <rect x="120" y="1080" width="420" height="74" rx="16" fill="url(#card)" stroke="#0f766e" stroke-width="2"/>
    <text x="146" y="1125" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="20" font-weight="700" fill="#0f172a">12. Final result persisted</text>
  </g>

  <g filter="url(#shadow)">
    <polygon points="780,842 900,912 780,982 660,912" fill="#ffffff" stroke="#334155" stroke-width="2"/>
    <text x="735" y="907" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="18" font-weight="700" fill="#0f172a">Broken JSON?</text>

    <rect x="960" y="876" width="360" height="72" rx="16" fill="url(#card)" stroke="#f59e0b" stroke-width="2"/>
    <text x="988" y="920" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="20" font-weight="700" fill="#0f172a">9. Phase B: repair JSON</text>

    <polygon points="780,1012 900,1082 780,1152 660,1082" fill="#ffffff" stroke="#334155" stroke-width="2"/>
    <text x="726" y="1077" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="18" font-weight="700" fill="#0f172a">Need correction?</text>

    <rect x="960" y="1046" width="360" height="72" rx="16" fill="url(#card)" stroke="#f97316" stroke-width="2"/>
    <text x="988" y="1090" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="20" font-weight="700" fill="#0f172a">10. Phase C: correct values</text>

    <polygon points="780,1174 900,1244 780,1314 660,1244" fill="#ffffff" stroke="#334155" stroke-width="2" transform="translate(0,-142)"/>
    <text x="736" y="1107" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="18" font-weight="700" fill="#0f172a">Still risky?</text>

    <rect x="960" y="1110" width="360" height="72" rx="16" fill="url(#card)" stroke="#ef4444" stroke-width="2"/>
    <text x="988" y="1154" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="20" font-weight="700" fill="#0f172a">11. Human review loop</text>
  </g>

  <path d="M330 204 L330 248" stroke="#334155" stroke-width="3" marker-end="url(#arrow)"/>
  <path d="M330 322 L330 366" stroke="#334155" stroke-width="3" marker-end="url(#arrow)"/>
  <path d="M330 440 L330 484" stroke="#334155" stroke-width="3" marker-end="url(#arrow)"/>
  <path d="M330 558 L330 602" stroke="#334155" stroke-width="3" marker-end="url(#arrow)"/>
  <path d="M330 676 L330 720" stroke="#334155" stroke-width="3" marker-end="url(#arrow)"/>
  <path d="M330 794 L330 838" stroke="#334155" stroke-width="3" marker-end="url(#arrow)"/>

  <path d="M540 875 L660 912" stroke="#334155" stroke-width="3" marker-end="url(#arrow)"/>
  <path d="M780 982 L780 1012" stroke="#334155" stroke-width="3" marker-end="url(#arrow)"/>

  <path d="M900 912 L960 912" stroke="#0f5cad" stroke-width="3" marker-end="url(#arrowBlue)"/>
  <text x="918" y="896" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="14" fill="#0f5cad">yes</text>
  <path d="M1320 912 C1400 912, 1400 1000, 540 1000" stroke="#0f5cad" stroke-width="3" fill="none" marker-end="url(#arrowBlue)"/>
  <text x="1340" y="930" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="14" fill="#0f5cad">to validate</text>

  <path d="M780 1082 L780 1102" stroke="#334155" stroke-width="3" marker-end="url(#arrow)"/>

  <path d="M900 1082 L960 1082" stroke="#0f5cad" stroke-width="3" marker-end="url(#arrowBlue)"/>
  <text x="918" y="1066" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="14" fill="#0f5cad">yes</text>
  <path d="M1320 1082 C1400 1082, 1400 1138, 900 1138" stroke="#0f5cad" stroke-width="3" fill="none" marker-end="url(#arrowBlue)"/>
  <text x="1342" y="1100" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="14" fill="#0f5cad">check risk</text>

  <path d="M900 1138 L960 1146" stroke="#0f5cad" stroke-width="3" marker-end="url(#arrowBlue)"/>
  <text x="918" y="1125" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="14" fill="#0f5cad">yes</text>

  <path d="M1320 1146 C1430 1146, 1430 1120, 540 1120" stroke="#0f5cad" stroke-width="3" fill="none" marker-end="url(#arrowBlue)"/>
  <text x="1332" y="1167" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="14" fill="#0f5cad">review done</text>

  <path d="M780 912 C620 912, 620 995, 540 995" stroke="#334155" stroke-width="3" fill="none" marker-end="url(#arrow)"/>
  <text x="604" y="926" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="14" fill="#334155">no</text>
  <path d="M780 1082 C620 1082, 620 1120, 540 1120" stroke="#334155" stroke-width="3" fill="none" marker-end="url(#arrow)"/>
  <text x="604" y="1098" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="14" fill="#334155">no</text>
  <path d="M780 1102 C620 1102, 620 1120, 540 1120" stroke="#334155" stroke-width="3" fill="none" marker-end="url(#arrow)"/>
  <text x="604" y="1116" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="14" fill="#334155">no</text>

  <rect x="48" y="1128" width="1380" height="50" rx="12" fill="#ffffff" stroke="#cbd5e1"/>
  <text x="72" y="1160" font-family="IBM Plex Sans, Segoe UI, Arial, sans-serif" font-size="15" fill="#334155">Solid arrows: main/control flow | Blue arrows: branch paths (repair/correction/review)</text>
</svg>
